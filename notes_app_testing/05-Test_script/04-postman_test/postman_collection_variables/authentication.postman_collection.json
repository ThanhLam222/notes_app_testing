{
	"info": {
		"_postman_id": "5ae454b4-7d52-4f52-84fd-ab1feef5e43b",
		"name": "1. Authentication",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "46966736",
		"_collection_link": "https://spaceflight-technologist-5034671-5912520.postman.co/workspace/Note-app-testing~594e2783-9472-4812-a12d-398cfffb1e8f/collection/46966736-5ae454b4-7d52-4f52-84fd-ab1feef5e43b?action=share&source=collection_link&creator=46966736"
	},
	"item": [
		{
			"name": "Get Sign up",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const cheerio = require('cheerio');\r",
							"const $ = cheerio.load(pm.response.text());\r",
							"\r",
							"pm.test(\"Should return 200 OK with sign up form\", function () {\r",
							"    // Check status and headers\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(pm.response.headers.get('Content-Type')).to.include(\"text/html\");\r",
							"    pm.expect(pm.cookies.get('sessionid')).to.not.be.null;\r",
							"\r",
							"    // Check HTML structure\r",
							"    // Check title of page\r",
							"    pm.expect($('h4').text().trim()).to.equal('Account Register');\r",
							"\r",
							"    // Check form action\r",
							"    const form = $('form');\r",
							"\r",
							"    pm.expect(form.attr('action')).to.equal('/auth/signup');\r",
							"    pm.expect(form.attr('method')).to.equal('POST');\r",
							"\r",
							"    // Check form fields\r",
							"    const fieldsForm = $('div.mb-3');\r",
							"\r",
							"    pm.expect(fieldsForm.length).to.equal(4);\r",
							"    const expectedNameFields = ['Name:', 'Email:', 'Password:', 'Confirm Password:'];\r",
							"    fieldsForm.each((i, el) => { \r",
							"        pm.expect($(el).find('label').text().trim()).to.equal(expectedNameFields[i]);\r",
							"    });\r",
							"\r",
							"    // Check sign up button\r",
							"    const signUpButton = $('form > button');\r",
							"    pm.expect(signUpButton.text().trim()).to.equal('Signup');\r",
							"\r",
							"    // Check linkable text\r",
							"    const linkableText = $('p.text-center');\r",
							"    pm.expect(linkableText.text().trim()).to.match(/Already Have an Account\\?\\s*Login/);\r",
							"    pm.expect(linkableText.find('a').attr('href')).to.equal('/auth/signin');\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}auth/signup",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"signup"
					]
				}
			},
			"response": []
		},
		{
			"name": "Post Sign up",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"const counter = pm.collectionVariables.get(\"signUpCounter\") || 1;\r",
							"const email = `user${counter}@example.com`;\r",
							"\r",
							"pm.variables.set(\"signUpEmail\", email);\r",
							"pm.collectionVariables.set(\"signUpCounter\", counter + 1);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const cheerio = require('cheerio');\r",
							"const $ = cheerio.load(pm.response.text());\r",
							"\r",
							"pm.test(\"Should returns 200 OK and message 'You are registered' appears after successful signup\", function () {\r",
							"    // Check status and headers\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/html');\r",
							"    pm.expect(pm.cookies.get('sessionid')).to.not.be.null;\r",
							"\r",
							"    // Check body and messages\r",
							"    pm.expect($('h1').text().trim()).to.equal(\"Account Login\");\r",
							"    \r",
							"    const messages = $('div.alert');\r",
							"    pm.expect(messages.length).to.equal(1);\r",
							"    pm.expect(messages.text().trim()).to.equal(\"You are registered.\");\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "name",
							"value": "user",
							"type": "text"
						},
						{
							"key": "email",
							"value": "{{signUpEmail}}",
							"type": "text"
						},
						{
							"key": "password",
							"value": "usertestpassword",
							"type": "text"
						},
						{
							"key": "confirm_password",
							"value": "usertestpassword",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{baseUrl}}auth/signup",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"signup"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Sign in",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const cheerio = require('cheerio');\r",
							"const $ = cheerio.load(pm.response.text());\r",
							"\r",
							"pm.test( \"Should returns 200 OK with sign in form\", () => {\r",
							"    // Check status and headers\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/html');\r",
							"    pm.expect(pm.cookies.get('sessionid')).to.not.be.null;\r",
							"\r",
							"    // Check body\r",
							"    pm.expect($('h1').text().trim()).to.equal('Account Login');\r",
							"\r",
							"    // Check form action\r",
							"    const form = $('form');\r",
							"    pm.expect(form.attr('action')).to.equal('/auth/signin');\r",
							"    pm.expect(form.attr('method')).to.equal('POST');\r",
							"\r",
							"    // Check form fields\r",
							"    const fieldsForm = $('div.mb-3');\r",
							"    pm.expect(fieldsForm.length).to.equal(2);\r",
							"\r",
							"    const expectedNameFields = [\"Email:\", \"Password:\"];\r",
							"    fieldsForm.each((i, el) => {\r",
							"        pm.expect($(el).find('label').text().trim()).to.equal(expectedNameFields[i]);\r",
							"    });\r",
							"\r",
							"    // Check sign in button\r",
							"    const signInButton = $('form > button');\r",
							"    pm.expect(signInButton.text().trim()).to.equal('Signin');\r",
							"\r",
							"    // Check linkable text\r",
							"    const linkableText = $('p.text-center');\r",
							"\r",
							"    pm.expect(linkableText.text().trim()).to.match(/Don't Have an Account\\?\\s*Register/);\r",
							"    pm.expect(linkableText.find('a').attr('href')).to.equal('/auth/signup');\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}auth/signin",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"signin"
					]
				}
			},
			"response": []
		},
		{
			"name": "Post Sign in",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const cheerio = require('cheerio');\r",
							"const $ = cheerio.load(pm.response.text());\r",
							"\r",
							"pm.test(\"Should return 200 OK with All notes page\", () => {\r",
							"    // Check status and headers\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/html');\r",
							"    pm.expect(pm.cookies.get('sessionid')).to.not.be.null;\r",
							"\r",
							"    // Check body\r",
							"    const allNotes = $('div.col-md-3')\r",
							"    const countNotes = allNotes.length;\r",
							"    if(countNotes > 0) {\r",
							"        allNotes.each((i, el) => {\r",
							"        pm.expect($(el).find('h4.card-title').text().trim()).to.not.be.empty;\r",
							"        pm.expect($(el).find('p').text().trim()).to.not.be.empty;\r",
							"        });\r",
							"    }\r",
							"    else {\r",
							"        pm.expect($('p.lead').length).to.equal(1);\r",
							"        pm.expect($('p.lead').text().trim()).to.equal(\"There are not Notes yet.\");\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "email",
							"value": "admin@localhost",
							"type": "text"
						},
						{
							"key": "password",
							"value": "adminpassword",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{baseUrl}}auth/signin",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"signin"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Log out",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const cheerio = require('cheerio');\r",
							"const $ = cheerio.load(pm.response.text());\r",
							"\r",
							"pm.test(\" Should return 200 OK and 'You are logged out now.' appears after logout succeeds\", () => {\r",
							"    // Check status and headers\r",
							"    pm.response.to.have.status(200);\r",
							"    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/html');\r",
							"    pm.expect(pm.cookies.get('sessionid')).to.not.be.null;\r",
							"\r",
							"    // Check body\r",
							"    pm.expect($('h1').text().trim()).to.equal(\"Account Login\");\r",
							"\r",
							"    const messages = $('div.alert');\r",
							"    pm.expect(messages.length).to.equal(1);\r",
							"    pm.expect(messages.text().trim()).to.equal(\"You are logged out now.\");\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disabledSystemHeaders": {
					"host": true
				}
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "",
						"value": "",
						"type": "text",
						"disabled": true
					}
				],
				"url": {
					"raw": "{{baseUrl}}auth/logout",
					"host": [
						"{{baseUrl}}auth"
					],
					"path": [
						"logout"
					]
				}
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "signUpCounter",
			"value": ""
		}
	]
}